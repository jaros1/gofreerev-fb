 1) how much information to se about deals between friends and friends friends?
    facebook: Shows status from friends on wall - do not show status from friends friends on wall
    Show gifts started by friends as giver or receiver with all pictures and comments
    Anonymous gifts started by friends friends as giver or receiver and with friends as receiver or giver
    - display received at and balance.
    - hide picture and name of friends friend
    - hide text and pictures

 2) compare JS timezone with rails timezones - there could be differences
    I have tested with copenhagen and india
    Rails timezones:
    - ActiveSupport::TimeZone.all.collect { |tz| (tz.tzinfo.current_period.utc_offset / 60.0 / 60.0).to_s }.uniq
    - ["-11.0", "-10.0", "-9.0", "-8.0", "-7.0", "-6.0", "-5.0", "-4.5", "-4.0", "-3.5", "-3.0", "-2.0", "-1.0",
       "0.0", "1.0", "2.0", "3.0", "3.5", "4.0", "4.5", "5.0", "5.5", "5.75", "6.0", "6.5", "7.0", "8.0", "9.0",
       "9.5", "10.0", "11.0", "12.0", "12.75", "13.0"]
    javascript timezones:
    wiki: http://en.wikipedia.org/wiki/Time_zone#List_of_UTC_offsets
    wiki/rails problems: -9.5, 10.5, 11.5 and 14 is defined in wiki, but not in rails
    rails: http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html
    The version of TZInfo bundled with Active Support only includes the definitions necessary to support the zones
    defined by the TimeZone class. If you need to use zones that aren't defined by TimeZone, you'll need to install
    the TZInfo gem (if a recent version of the gem is installed locally, this will be used instead of the bundled version

 3) add date format. see application_helper.format_date

 4) api notifications:
    get a app access token.
    send only notifications to api if internal notifications in app is not read.
    Short summary of unread app notifications in api notification
    Only few api notifications and stop sending messages if user do not start app
    for example notification every 1, 2, 4, 7, 14, 28 day
    one notification every day if user connects to app.
    don't send any more notifications if user has not been connected for 28 days
    check out facebook, linkedin & twitter notification possibilities

 5) add accept conditions for new users?

 6) make script to compare language files (en, da etc). Find missing keys
    check out https://github.com/tigrish/i18n-spec
    could be used to verify that all keys exists

 7) recalculate user balance at request or once every day

 8) user.recalculate_balance recalculates balance for all closed deals with user as giver or receiver.
    ok when few closed deals for a user, but can be a performance issue with many closed deals for a user.
    allow recalculating balance from a specific date or from a specific gift.id
    should only recalculate balance from last closed deal

 9) batch processing:
    accept new deal - set new_balance_at = yesterday - for both users - user is marked for recalculate balance (ok)
    batch processing - recalculate balance for all users where new_balance_at != today (todo)

10) check texts in views/fb/create.html.erb and create_da_html.erb

11) show a more informative page when not logged in
    ensure that all not logged users is rendered to same page (auth/index)
    this page is also index by search engines and should be informative
    maybe the same texts as in /fb/create.html.erb and create_da_html.erb pages

12) check todo's in source

13) add language to url (ok)
    use url helpers in views so that locale is included in all links
    there is a minor problem with double language /en/en/ in url for restful controllers

14) difference between facegook & linkedin friends and google+ & twitter friends
    facebook & linkedin friends are mutual friends
    google+ and twitter friends are not mutual friends
    added constant hash API_MUTUAL_FRIENDS with true/false for each login provider
    how to handle not mutual friends in gofreerev? (google+ and twitter)

15) delete api_gifts and gifts with temp picture urls - that is picture on server
    normally temp pictures will be removed in util.delete_local_picture, but errors can occur
    should be a job for util.new_messages_count or util.missing_api_picture_urls
    process could be:
    1) delete old local picturs.
    2) report missing picture to util.missing_api_picture_urls,
    3) cleanup in util.missing_api_picture_urls
    3/1-2014: temp folder was empty in laptop dev. environment
    19/1-2014: 3 pictures found in temp folder in laptop dev. environment

16) find some way to combine or group "identical" notifications in inbox/index page

17) stress test. make a db with really many rows and test performance.
    There maybe are missing an index or two
    there maybe are some sql to rewrite

18) some problems in user.recalculate balance after splitting gifts in gifts and api_gifts
    check /auth/facebook and post_login error for price

19) twitter returns to  127.0.0.1 - not to localhost
    127.0.0.1 should redirect to localhost
    or change app setup on twitter

20) check session variables
    session variables should only be used from accessor methods in app. controller
    gives a better overview and an easier to maintain code

21) tests - needs new users.yml file - encryption now is with old userids

22) wrong flash message if user cancel request for read_stream permission
    looks like success response from facebook to facebook controller,
    but read_stream priv has not been granted.
    must double check permissions after returning from facebook priv. request page
    or old/new facebook priv. could be checked in post_login_facebook with ajax messages

23) deep link - return nice error page if deep link has been removed

24) test case:
    create deal [ a.provider1, a.provider2] as giver, [ b.provider1, b.provider2 ] as receiver, price > 0
    login as a.provider1 and b.provider2
    problem with user/show balance. logged users are giver and receiver at the same time
    must be displayed as 0 in balance
    check code with [ag.user_id_giver, ag.user_id_receiver].index(user_id)
    check code with login_user_ids.index(ag.user_id_giver)
    check code with api_gift = api_gifts.find { |ag| [ ag.user_id_giver, ag.user_id_receiver].index(???)

25) generalize invite_friends_url
    invite friends to user gofreerev.
    facebook (ok)
    google+ (todo) -
    linkedin (todo)
    twitter (todo)

26) find optimal image format for each provider. For API_OG_DEF_IMAGE hash
    facebook: todo
    google+: todo
    linkedin: 180 x 110 (done)
    twitter: todo
    must be tested from an public available server (dev1.gofreerev.com)

27) add mysql development environment on localhost.
    there are some select statements that are not working in mysql
    maybe is only was problem with "" around table names!

28) insert "?" picture in /user div/ temporary real profile picture has been downloaded from API
    there is a minor profile picture problem first time when a new gofreerev user logs in

29) problem after show-more-rows error
    javascript variable end_of_page is set to true and is never changed back to false
    share link does not set end_of_page variable back to false
    /gifts/index does set end_of_page back to true
    maybe use document.ready to set end_of_page to false when user clicks on share link i page header
    google a solution

30) remove api friend:
    - facebook: link to profile
    - linkedin: todo
    - google+: todo
    - twitter: todo

31) check notifications and change notification test cases to support multiple logins

32) check app on windows 8.1 / IE
    maybe it is possible to run older IE versions under windows 8.1?
    expects some javascript errors under IE

33) better github page
    check how to add wiki pages

34) links on app setup pages to github page (wiki, report bugs etc)
    check app setup for facebook, google+, linkedin and twitter

35) post on linkedin from localhost
    can not upload picture with localhost url to linkedin
    add a special error message for this case?

36) invalid deep link requests
    should display an error page
    must not redirect for not logged in users

37) add server site cleanup for api_gifts with temp url
    created in gifts/create - removed in util.delete_local_picture after post_on_<provider> tasks

38) profile picture store = :api.
    should display no-picture.jpg if user profile picture was not found

39) check if user div onclick events could be handled on a higher level - for example on document
    can not use user_id in id. user divs are repeated many times for each user.
    use data-id attribute for user.id

40) link from post on gofreerev to post on facebook. api_gift.api_gift_id => url
    but only if FB friend

41) link from post on gofreerev to post on linkedin. updateUrl
    but only if LinkedIn connection

42) facebook and open graph
    - replace api_client.put_picture and api_client.put_connections with something else to add open graph tags?
    - facebook object api: https://developers.facebook.com/docs/opengraph/using-object-api/
    - koala with og.likes:
      http://stackoverflow.com/questions/12199608/koala-like-doesn-t-work
      api_response = api.put_connections("me", "og.likes", :object => deep_link)
      can be used, but requires :local gift picture store and activity is  only shown in activity log / not on wall
    - facebook object debugger: https://developers.facebook.com/tools/debug/

43) check response from FastImage.type(gift_file.path) if site is temporary unavailable
    should not error mark pictures if a api picture server is temporary out of service
    FastImage.type returns nil if server is temporary unavailable
    Must combine FastImage = nil with a http get page notfound check
    http://stackoverflow.com/questions/2695020/how-can-i-use-ruby-to-check-if-a-domain-exists

44) found class wrapword in source - used in api_gift.html.erb - could be a workaround for response web pages with small width

45) user/show: add provider filter if logged in with more when one provider

46) add share icons to api_gift (one icon for each api provider)
    share with a deep link
    allow all to share og allow only creator to share?
    http://jquery-plugins.net/tag/social-share-button

47) inject text into picture
    most relevant for twitter where description is truncated to about 70 characters to include deep link
    but could be an option for all login providers
    for example a merge text and picture checkbox when posting new gift
    could be relevant for other login providers where text overlay in pictures is being used

48) my.js - split gift-action-link ajax handler in one for each gift action?
    should use translated error messages in js error messages
    or use url information to customize ajax:error messages

49) my.js - split comment-action-link ajax handler in one for each comment action?
    should use translated error messages in js error messages
    or use url information to customize ajax:error messages

50) deal proposal and changed friend relations
    cancel deal proposal when friends are removed
    could be remove friends in users/index page
    could be changed api friend relation in post login task

51) jquery. url from xhr object is used to find html element that triggered the ajax event
    for example to setup tables for ajax error messages within gifts/index page
    it could be nice if jquery has information about the html element that started the ajax request
    $(classname).bind('click', function ... - find id for html element with classname with triggered this bind handler

52) new gift.status_update_at after new comments?
    In that way updated gifts will be at top of page and will be ajax injected to top of page
    how to keep actual user view point when ajax injecting new rows in top of page?

53) check if notification cleanup still is running. Find 68 notifications for 3 login users.

54) edit user options
    - cross provider balance y/n checkbox

55) a number of "invalid" inbox notification keys. Could be missing keys. Could be wrong notifications

    missing translate key. key .accepted_proposal_giver_follow_2_v1_to_url, noti.id 542,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Gofreerev A", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_follow_2_v1_to_url

    missing translate key. key .accepted_proposal_giver_follow_2_v1_to_msg, noti.id 542,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Gofreerev A", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_follow_2_v1_to_msg

    Notification 542 to 100006397022113/facebook Charlie S

    1) gift 894
       created Fri, 24 Jan 2014 10:35:02 UTC +00:00
       created by givers 100006399422155/facebook Sandra Q, 109316109373670614208/google_oauth2 and 2179784783/twitter Jan R
    2) new deal proposal comment id 754
       created 2014-01-24 10:35:19
       created by 100006397022113/facebook Charlie S
    3) accept deal proposal comment id 754
       accepted 2014-01-24 10:35:37
       accepted by 100006399422155/facebook Sandra Q


    giver = 100006399422155/facebook Sandra Q,               receiver = 100006397022113/facebook Charlie S
    giver = 109316109373670614208/google_oauth2 Gofreerev A, receiver = gofreerev/google_oauth2 Gofreerev G
    giver = 2179784783/twitter Jan R,                        receiver = gofreerev/twitter Gofreerev T
    Deal between Sandra Q and Charlie S - dummy receivers for google+ and twitter

    Notification 541 :

    ============================================================================

    missing translate key. key .accepted_proposal_giver_2_v1_to_url, noti.id 541,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Sandra Q", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_2_v1_to_url

    missing translate key. key .accepted_proposal_giver_2_v1_to_msg, noti.id 541,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Sandra Q", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_2_v1_to_msg

    missing translate key. key .new_comment_giver_follow_1_v1_from_url, noti.id 341,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_url

    missing translate key. key .new_comment_giver_follow_1_v1_from_msg, noti.id 341,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_msg

    missing translate key. key .new_comment_giver_follow_1_v1_from_url, noti.id 340,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_url

    missing translate key. key .new_comment_giver_follow_1_v1_from_msg, noti.id 340,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_msg

    missing translate key. key .new_comment_giver_follow_1_v1_from_url, noti.id 339,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_url

    missing translate key. key .new_comment_giver_follow_1_v1_from_msg, noti.id 339,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 297,
    options {:giftid=>"265", :gifttext=>"accept test 12", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 297,
    options {:giftid=>"265", :gifttext=>"accept test 12", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 293,
    options {:giftid=>"263", :gifttext=>"accept test 10", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 293,
    options {:giftid=>"263", :gifttext=>"accept test 10", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 277,
    options {:giftid=>"255", :gifttext=>"test accept 2", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 277,
    options {:giftid=>"255", :gifttext=>"test accept 2", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 275,
    options {:giftid=>"254", :gifttext=>"test accept", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 275,
    options {:giftid=>"254", :gifttext=>"test accept", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 273,
    options {:giftid=>"253", :gifttext=>"Cykel", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 273,
    options {:giftid=>"253", :gifttext=>"Cykel", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

56) add deleted_at to api_gift and api_comment for partial delete of gift and comment
    ( gift and comment created with multi provider login )

57) change User.api_gifts to include api_gifts,deleted_at information.
    that is - ajax remove gift from gifts/index page

58) change util/new_messages_count to include delete marked api comments
    that is - ajax remove comment from gifts/index page

59) no language in inbox urls. Should keep current language code in all links

60) delete account notifications.
    add some more information
    - number of deals
    - sum prices for deleted deals

61) accept deal in gifts/show does not work 100%
    deal is accepted but gift is removed from gifts/show without being ajax replaced with closed deal

62) add language LOV to page header if width > xxx

63) edit/user share balance

64) performance problem in users/index page - 12 seconds for 10 rows at dev1 / my FB account

65) can not change currency to USD: Currency was not changed. No currency rates was found

66) refactor #user_currency_new and #user_currency_new2 handlers into one class based event handler

67) "false" ajax:error message if user clicks in a link before ajax request has finished.
    something like ajax:error - more information in server log - server log is ok
    maybe cancel ajax requests or ignore ajax:error message when changing page
    check if there is an "before leave page" event

68) add special post_login_<xxx> messages for first time visitters
    flash: is now downloading information of your friends. You will could see your friends within gofreerev in a few moments.
    ajax after post_login: added friends information for <n> friends. Please refresh page or gå to friends page to manage your friends.

69) add profile picture for a new user in auth, facebook and linkedin controllers to prevent blank profile picture after login

70) ajax comment inject does not work in IE. No error messages in IE. Must write some more information to debug log.
    ajax comment does neither work in dev. environment

72) problem with missing profile pictures om dev1 / jr

73) invalid api_gifts.api_picture_url - looks like description + deep_link
    added validation to api_gifts.api_picture_url

74) missing ajax:error in chrome if server is not running
    should ajax inject error message inside page under gift links/comment row
    check gift and comments links

76) IE dev1 sharon login started from FB fails with cross site request forgery
    but no error when FB login starts from Gofreerev.
    no cross site request forgery problem for firefox dev1 when login starts from facebook

77) add try+catch for all ajax:success event handlere to catch any JS errors
    firefox only return "parseerror" and no other information if there is any error in ajax:success code

