 1) how much information to se about deals between friends and friends friends?
    facebook: Shows status from friends on wall - do not show status from friends friends on wall
    Show gifts started by friends as giver or receiver with all pictures and comments
    Anonymous gifts started by friends friends as giver or receiver and with friends as receiver or giver
    - display received at and balance.
    - hide picture and name of friends friend
    - hide text and pictures

 2) compare JS timezone with rails timezones - there could be differences
    I have tested with copenhagen and india
    Rails timezones:
    - ActiveSupport::TimeZone.all.collect { |tz| (tz.tzinfo.current_period.utc_offset / 60.0 / 60.0).to_s }.uniq
    - ["-11.0", "-10.0", "-9.0", "-8.0", "-7.0", "-6.0", "-5.0", "-4.5", "-4.0", "-3.5", "-3.0", "-2.0", "-1.0",
       "0.0", "1.0", "2.0", "3.0", "3.5", "4.0", "4.5", "5.0", "5.5", "5.75", "6.0", "6.5", "7.0", "8.0", "9.0",
       "9.5", "10.0", "11.0", "12.0", "12.75", "13.0"]
    javascript timezones:
    wiki: http://en.wikipedia.org/wiki/Time_zone#List_of_UTC_offsets
    wiki/rails problems: -9.5, 10.5, 11.5 and 14 is defined in wiki, but not in rails
    rails: http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html
    The version of TZInfo bundled with Active Support only includes the definitions necessary to support the zones
    defined by the TimeZone class. If you need to use zones that aren't defined by TimeZone, you'll need to install
    the TZInfo gem (if a recent version of the gem is installed locally, this will be used instead of the bundled version

 3) add date format. see application_helper.format_date

 4) api notifications:
    get a app access token.
    send only notifications to api if internal notifications in app is not read.
    Short summary of unread app notifications in api notification
    Only few api notifications and stop sending messages if user do not start app
    for example notification every 1, 2, 4, 7, 14, 28 day
    one notification every day if user connects to app.
    don't send any more notifications if user has not been connected for 28 days
    check out facebook, linkedin & twitter notification possibilities

 5) add accept conditions for new users?

 7) recalculate user balance at request or once every day

 8) user.recalculate_balance recalculates balance for all closed deals with user as giver or receiver.
    ok when few closed deals for a user, but can be a performance issue with many closed deals for a user.
    allow recalculating balance from a specific date or from a specific gift.id
    should only recalculate balance from last closed deal

 9) batch processing:
    accept new deal - set new_balance_at = yesterday - for both users - user is marked for recalculate balance (ok)
    batch processing - recalculate balance for all users where new_balance_at != today (todo)

10) check texts in views/fb/create.html.erb and create_da_html.erb

11) show a more informative page when not logged in
    ensure that all not logged users is rendered to same page (auth/index)
    this page is also index by search engines and should be informative
    maybe the same texts as in /fb/create.html.erb and create_da_html.erb pages

12) check todo's in source

13) delete api_gifts and gifts with temp picture urls - that is picture on server
    normally temp pictures will be removed in util.delete_local_picture, but errors can occur
    should be a job for util.new_messages_count or util.missing_api_picture_urls
    process could be:
    1) delete old local picturs.
    2) report missing picture to util.missing_api_picture_urls,
    3) cleanup in util.missing_api_picture_urls
    3/1-2014: temp folder was empty in laptop dev. environment
    19/1-2014: 3 pictures found in temp folder in laptop dev. environment

14) find some way to combine or group "identical" notifications in inbox/index page

15) stress test. make a db with really many rows and test performance.
    There maybe are missing an index or two
    there maybe are some sql to be rewritten

18) check session variables
    session variables should only be used from accessor methods in app. controller
    gives a better overview and an easier to maintain code

19) tests - needs new users.yml file - encryption now is with old userids

20) wrong flash message if user cancel request for read_stream permission
    looks like success response from facebook to facebook controller,
    but read_stream priv has not been granted.
    must double check permissions after returning from facebook priv. request page
    or old/new facebook priv. could be checked in post_login_facebook with ajax messages

21) test case:
    create deal [ a.provider1, a.provider2] as giver, [ b.provider1, b.provider2 ] as receiver, price > 0
    login as a.provider1 and b.provider2
    problem with user/show balance. logged users are giver and receiver at the same time
    must be displayed as 0 in balance
    check code with [ag.user_id_giver, ag.user_id_receiver].index(user_id)
    check code with login_user_ids.index(ag.user_id_giver)
    check code with api_gift = api_gifts.find { |ag| [ ag.user_id_giver, ag.user_id_receiver].index(???)

22) find optimal image format for each provider. For API_OG_DEF_IMAGE hash
    facebook: todo
    google+: todo
    linkedin: 180 x 110 (done)
    twitter: todo
    maybe a mouse over text with best picture dimensions when attaching pictures

23) add mysql development environment on localhost.
    there are some select statements that are not working in mysql
    maybe is only was problem with "" around table names!
    also problems with float. Less float precession in mysql than in sqlite3

26) remove api friend:
    - facebook: link to profile
    - linkedin: todo
    - google+: todo
    - twitter: todo

27) check notifications and change notification test cases to support multiple logins

28) check app on windows 8.1 / IE
    maybe it is possible to run older IE versions under windows 8.1?
    expects some javascript errors under IE

29) better github page

30) links on app setup pages to github page (wiki, report bugs etc)
    check app setup for facebook, google+, linkedin and twitter

31) post on linkedin from localhost
    can not upload picture with localhost url to linkedin
    add a special error message for this case?

32) invalid deep link requests
    deep link - return nice error page if deep link has been removed
    should display an error page
    must not redirect for not logged in users

33) add server site cleanup for api_gifts with temp url
    created in gifts/create - removed in util.delete_local_picture after post_on_<provider> tasks

35) check if user div onclick events could be handled on a higher level - for example on document
    can not use user_id in id. user divs are repeated many times for each user.
    use data-id attribute for user.id

36) link from post on gofreerev to post on facebook but only if FB friend
    link from post on gofreerev to post on linkedin but only if LinkedIn connection
    should have small API icons for each post.
    multiple icons if multiple logins and post in multiple API's

39) check response from FastImage.type(gift_file.path) if site is temporary unavailable
    should not error mark pictures if a api picture server is temporary out of service
    FastImage.type returns nil if server is temporary unavailable
    Must combine FastImage = nil with a http get page notfound check
    http://stackoverflow.com/questions/2695020/how-can-i-use-ruby-to-check-if-a-domain-exists

41) add share icons to api_gift (one icon for each api provider)
    share with a deep link
    allow all to share or allow only giver/receiver to share?
    http://jquery-plugins.net/tag/social-share-button

43) my.js - split gift-action-link ajax handler in one for each gift action?
    should use translated error messages in js error messages
    or use url information to customize ajax:error messages

44) my.js - split comment-action-link ajax handler in one for each comment action?
    should use translated error messages in js error messages
    or use url information to customize ajax:error messages

45) deal proposal and changed friend relations
    cancel deal proposal when friends are removed
    could be remove friends in users/index page
    could be changed api friend relation in post login provider task

46) jquery. url from xhr object is used to find html element that triggered the ajax event
    for example to setup tables for ajax error messages within gifts/index page
    it could be nice if jquery has information about the html element that started the ajax request
    $(classname).bind('click', function ... - find id for html element with classname with triggered this bind handler

47) new gift.status_update_at after new comments?
    In that way updated gifts will be at top of page and will be ajax injected to top of page
    how to keep actual user view point when ajax injecting new rows in top of page?

49) edit user options
    - cross provider balance y/n checkbox
    - share balance

50) a number of "invalid" inbox notification keys. Could be missing keys. Could be wrong notifications

    missing translate key. key .accepted_proposal_giver_follow_2_v1_to_url, noti.id 542,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Gofreerev A", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_follow_2_v1_to_url

    missing translate key. key .accepted_proposal_giver_follow_2_v1_to_msg, noti.id 542,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Gofreerev A", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_follow_2_v1_to_msg

    Notification 542 to 100006397022113/facebook Charlie S

    1) gift 894
       created Fri, 24 Jan 2014 10:35:02 UTC +00:00
       created by givers 100006399422155/facebook Sandra Q, 109316109373670614208/google_oauth2 and 2179784783/twitter Jan R
    2) new deal proposal comment id 754
       created 2014-01-24 10:35:19
       created by 100006397022113/facebook Charlie S
    3) accept deal proposal comment id 754
       accepted 2014-01-24 10:35:37
       accepted by 100006399422155/facebook Sandra Q


    giver = 100006399422155/facebook Sandra Q,               receiver = 100006397022113/facebook Charlie S
    giver = 109316109373670614208/google_oauth2 Gofreerev A, receiver = gofreerev/google_oauth2 Gofreerev G
    giver = 2179784783/twitter Jan R,                        receiver = gofreerev/twitter Gofreerev T
    Deal between Sandra Q and Charlie S - dummy receivers for google+ and twitter

    Notification 541 :

    ============================================================================

    missing translate key. key .accepted_proposal_giver_2_v1_to_url, noti.id 541,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Sandra Q", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_2_v1_to_url

    missing translate key. key .accepted_proposal_giver_2_v1_to_msg, noti.id 541,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Sandra Q", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_2_v1_to_msg

    missing translate key. key .new_comment_giver_follow_1_v1_from_url, noti.id 341,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_url

    missing translate key. key .new_comment_giver_follow_1_v1_from_msg, noti.id 341,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_msg

    missing translate key. key .new_comment_giver_follow_1_v1_from_url, noti.id 340,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_url

    missing translate key. key .new_comment_giver_follow_1_v1_from_msg, noti.id 340,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_msg

    missing translate key. key .new_comment_giver_follow_1_v1_from_url, noti.id 339,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_url

    missing translate key. key .new_comment_giver_follow_1_v1_from_msg, noti.id 339,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 297,
    options {:giftid=>"265", :gifttext=>"accept test 12", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 297,
    options {:giftid=>"265", :gifttext=>"accept test 12", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 293,
    options {:giftid=>"263", :gifttext=>"accept test 10", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 293,
    options {:giftid=>"263", :gifttext=>"accept test 10", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 277,
    options {:giftid=>"255", :gifttext=>"test accept 2", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 277,
    options {:giftid=>"255", :gifttext=>"test accept 2", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 275,
    options {:giftid=>"254", :gifttext=>"test accept", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 275,
    options {:giftid=>"254", :gifttext=>"test accept", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 273,
    options {:giftid=>"253", :gifttext=>"Cykel", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 273,
    options {:giftid=>"253", :gifttext=>"Cykel", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

51) add deleted_at to api_gift and api_comment for partial delete of gift and comment
    gift and comment created with multi provider login and one login account has been deleted

52) change User.api_gifts to include api_gifts.deleted_at information.
    that is - ajax remove gift from gifts/index page in util.new_messages_count
    delete gift for only one provider when account is closed

53) change util/new_messages_count to include delete marked api comments
    that is - ajax remove comment from gifts/index page in util.new_messages_count
    delete comment for only one provider when account is closed

54) delete account notifications.
    add some more information
    - number of deleted deals
    - sum prices for deleted deals

56) add language LOV to page header if width > xxx

60) "false" ajax:error message if user clicks in a link before ajax request has finished.
    "tasks_form.error: error. check server log for more information."
    maybe cancel ajax requests or ignore ajax:error message when changing page
    check if there is an "before leave page" event that can be used to cancel ajax request
    or disable error from ajax:error handlers
    also a special problem in chrome where you have to link twice on links if ajax tasks is running

64) gift giver pic mouse over text should have information about multiple provider givers
    gift receiver pic mouse over text should have information about multiple provider receivers

65) google+ and twitter.
    how to prevent friend invitations from people you do not know?
    F - you are following someone on google+ and twitter, and do not want to receive friend invitations from them
    S - you are stalked by someone on google+ and twitter and do not want to receive friend invitations from them
    block all and allow selected users
    allow all and block selected users

66) allow device fingerprint guest user login?
    that is login without username/password
    no friends information!
    could use user ip location and distance to other gofreerev users instead of a friend list
    user could select between api login or ip location/device fingerprint login

67) allow device fingerprint for users that reject cookies?
    must have cookie store on server for users with device fingerprint login
    could not find anything about device fingerprint session store or a device fingerprint plugins for rails

68) User.api_gifts
    maybe problem with very big select if really many friends for logged in users
    on other option could be 2 sub queries combined with filter for deselected friends
    select * from api_gifts
    where user_id_giver in (select ...) and user_id_giver not in (1,2,3, ..)
    or    user_id_receiver in (select ...) and user_id_receiver not in (1,2,3, ..)

70) users/index status mouse over with number of mutual friends was been dropped
    maybe add a ajax mouse over title - that is - calculate number of mutual friends when needed and not always
    good performance at startup and nice to have for the users when selecting friends

71) check out JS API's for login providers. most interesting are readonly API's (google+ and instagram)
    some not supported server site operations could be implemented with client side JS

72) users/index - friends of friends - why in list - show name(s) of friend
    maybe the same issue as in previous dropped mutual friends

75) find a better location for ajax tasks spinner in top of page
    show/hide spinner makes the page bouncing
    add mouse over title to ajax tasks title with explanation.
    maybe after ".create_gift_header_line"
    Maybe under ".description_prompt"

76) add mini spinners for some time consuming tasks.
    for example deleting a closed deal (recalculate balance)

77) Midori: problems with utf-8 in some paths of gifts/index page - looks like a temporary problem

79) users/index: search, friend name filter or alphabetical tabs
    it is slow to scroll down (bad performance + 3 seconds delay for each 10 rows lookup)

80) chrome and running ajax tasks
    you have to click twice on links if an ajax tasks is running when clicking on link
    ajax error message at first click and http request at second click
    not a problem in firefox, opera, IE or Midori.

81) opera 12.16 bug when gofreerev starts from facebook https://apps.facebook.com/gofreerev-dev/
    Warning
    https://dev1.gofreerev.com/
    A page on the public internet requests data from your private intranet.
    For security reasons, automatic access is blocked, but you may choose to continue.
    Continue
    Always continue when data is requested from this server on my private intranet
    Generated by Opera.
    Only problem in first https://apps.facebook.com/gofreerev-dev/ request => get /
    Second https://apps.facebook.com/gofreerev-dev/ request => post /
    Opera console does not reveal any rejected localhost requests. But should not start with a "get /" in log

82) opera. displays auth/index page within facebook iframe when gofreerev starts from facebook.

85) localhost / login servers Sandra/fb and Gofreerev A/gp
    2+2 notifications. 2 accepted and 2 accepted follow notification.
    for example 13. feb. 2014 11.58
    should only send notification to Sandra+Gofreerev as creator of proposal.
    should not send notification to Sandra+Gofreerev as follower of proposal.
    the same pattern for "outbox" for Jan R/google+ as sender of message.
    also 13. feb. 2014 11.58

86) add a API check to omniauth.rb
    check that all array constants are initialized for all login providers

87) how to check for an "official" gofreerev version
    easy to copy gofreerev and misuse the concept (harvest user information from API's)
    maybe a list of officiel gofreerev sites

88) users/index apiname=<provider> filter. Use login user = selected provider.
    in that way all user dev pictures are from the same login provider.

89) min ajax spinner in page header is missing while fetching new exchange rates

90) check if there is a generic JS way to count number of running/pending ajax requests

91) find all methods with case provider implementations. Should be listed in todo for adding a new login provider.
    maybe add a special search word that can be used to find all relevant points in source code when adding a new login provider
    add "API SETUP" comment for all case provider statements

95) users/index friends filter: add follows and followed by filters?

98) auth/index page
    - add * note for login providers that does not support post on wall
    - add missing provider? note. add a github page with request for missing login providers

99) users/edit change language
    - add note and link to github with instructions to how to add a new language to app
    - add github page about changing translations and adding new languages

100) linkedin gem. frozen to an old version due to error. Unfreeze when error is solved
     https://github.com/hexgnu/linkedin/issues/216

101) check if there is a problem with missing state in omniauth login.
     normally state should be included when using omniauth and callbacks

102) refactor linkedin & flickr controller translate keys into shared? Almost identical translations

104) post in foursquare. Foursquare is different from the other api's
     add a page for Gofreerev and ?
     maybe j has some ideas

109) problem with post from an empty gifts/index page (new users)
     rails post ok. client js fails with
     insert_update_gifts: 3 gifts lines in old page
     insert_update_gifts: error - id with format format gift-<999>- was not found
     in log and no error messages in page header
     on post_in_<provider> task was started

110) check out open graph meta-tags in flickr.
     maybe some that could by used
     <meta property="fb:app_id" content="137206539707334" />    x
     <meta property="og:title" content="u6bbc6h8oy" />
     <meta property="og:type" content="flickr_photos:photo" />
     <meta property="og:url" content="http://www.flickr.com/photos/gofreerev/12593199523/" />
     <meta property="og:site_name" content="Flickr" />
     <meta property="twitter:card" content="photo" />
     <meta property="twitter:site" content="@flickr" />
     <meta property="og:description" content="localhost/da/gifts/VyGiwGM7NXQ1JzBA2XAj1VV5zeGEtb" />
     <meta property="og:image" content="https://farm4.staticflickr.com/3716/12593199523_7600c19134_z.jpg" />
     <meta property="og:image:width" content="514" />
     <meta property="og:image:height" content="640" />
     <meta property="flickr_photos:by" content="http://www.flickr.com/people/gofreerev/" />
     <meta property="twitter:description" content="localhost/da/gifts/VyGiwGM7NXQ1JzBA2XAj1VV5zeGEtb" />

113) check just_posted variable in get_api_picture_url_<provider> methods
     should raise exception if just posted and picture was not found.
     see get_api_picture_url_facebook

115) two or three column friend list in users/index page.
     responsive design or use javascript to organize table layout
     could use float divs in a multi column users/index page
     that is fixed width, height and fixed table column size
     number of users in http/ajax requests should match number of columns.
     2 columns: get 2 friends in first request - get 20 friends in next request
     3 columns: get 3 friends in first request - get 30 friends in next request

116) post on twitter: Exception: execution expired (Twitter::Error) after 6 seconds
     added exception to post on twitter for debug
     maybe a generic way to handle execution expired when posting on api walls
     repeat up to 3 times before giving up
     return warning to user and try once more time
     delete_local_picture task and expired post on wall exception!

120) localhost - looking af gift id 909 logged in as Jan R/FB
     from user div ok = me
     to user div = dummy FB user gofreerev/facebook
     that is no information about google+ receiver 109316109373670614208/google_oauth2 Gofreerev A
     irb(main):009:0> [ g.api_gifts[0].giver.debug_info, g.api_gifts[0].receiver.debug_info ]
     => ["1705481075/facebook Jan R", "gofreerev/facebook Gofreerev F"]
     irb(main):010:0> [ g.api_gifts[1].giver.debug_info, g.api_gifts[1].receiver.debug_info ]
     => ["117657151428689087350/google_oauth2 Jan R", "109316109373670614208/google_oauth2 Gofreerev A"]
     also a comments from 100006399422155/facebook Sandra Q
     can not se that comments also was from 109316109373670614208/google_oauth2 Gofreerev A
     Not necessarily a problem as users normally will use there real names, but can be a problem in test

121) accepted deal comment. add accepted and price to comment

122) add timestamps to comments.

123) add a text truncated warning when posting on API and text is longer than allowed
     special relevant for tweets

124) add a text length counter when entering text. Twitter users would like to known how long the text is.

125) how to handle not logged in ajax errors
     login_required filter stops and no ajax is returned to client
     for example after expired token or deauthorization

126) api_profile_picture_url with small (50x50) and big (100x100) pictures.
     100x100 (5246 bytes) is only used in users/index and users/show
     50x50   (1744/2877 bytes) is used everywhere else
     can make a difference on a slow connection / slow device

128) ajax queue? or session table
     there are some small problems with cokie session store update and 2 running ajax requests
     request 1 updates a session variable and request 2 resets session variable to old value
     can be solved with an ajax queue
     can be solved by moving non vital session variables to session table
     last_row_id and last_row_at is now in sessions table

129) check all sorts
     old sort_by_user_name did have a very bad performance
     problem was detail sort by master fields

131) distribute option:
     find friends / see gifts on other gofreerev servers
     user-a id api friend with user-b, user-a is on server-a and user-b on server-b.
     user-a should be allowed to see user-b's gifts on server b
     user-b should be allowed to see user-a's gifts on server a

132) ruby profiler. It could be nice with a good ruby profiler statistic.
     http://hiltmon.com/blog/2012/02/27/quick-and-dirty-rails-performance-profiling/
     https://github.com/ruby-prof/ruby-prof
     http://david.paluy.org/blog/2013/04/09/profiling-rails-applications/

133) collect and organize screendumps

134) check that API_MAX_TEXT_LENGTHS constant is used for all api's

135) show-more-text link for long descriptions.
     could be a pure client JS solution.
     xxxx <a href="javascript: yyy" title="zzzz">show more</a>
     replace link with zzzz

136) check that direction is included for all wall posts

137) tests
     long text post without picture for all API's
     long text post with picture for all API's
     maybe different limit between short and long text in gifts/api_gift (share) and in users/api_gift (balance)
     longer texts in gifts/api_gift and shorter texts in users/api_gift
     make limit responsive? shorter texts in a small screen and longer texts in a big screen? (JS)

138) compare gifts/api_gift and users/api_gift partial
     merge into one shared partial?
     also compare translate keys

139) get screen width together with timezone
     get screen width in show-more-rows ajax request
     shorter text on small screen - longer text on wide screen
     I would be nice if JS could handle display text lengths

140) css wrapword. word-break: break-all;.
     works fine on small width screens but do not look nice on wide screens.
     there has been implemented a workaround for opera 12 that does not support break-all.
     it could be nice to avoid break-all on wide screens but there would still be a problems with long texts without spaces
     a possibility could be hyphenator to insert soft hyphen into text: https://code.google.com/p/hyphenator/


141) problem with ie10 new gift with very large text.
     submit bottom is moved under text area on wide pc screen

143) autoremove max height if text if only a bit heigher than max heigt

145) opera 12, gifts/index page
     gift text starts inside empty receiver user div
     that is - table layout is not respected

146) opera 12 - check errors - 111 errors :
            Invalid value for property: white-space
          white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
      ------------------------------------------^	Linked-in stylesheet	application.css:66
            Invalid value for property: white-space
          white-space: -o-pre-wrap;    /* Opera 7 */
      -----------------------------^	Linked-in stylesheet	application.css:67
            word-break is an unknown property
          word-break: break-all;
      ---------------^	Linked-in stylesheet	application.css:70
            -ms-text-size-adjust is an unknown property
          -ms-text-size-adjust: 100%; /* 2 */
      -------------------------^	Linked-in stylesheet	normalize.css:69
            -webkit-text-size-adjust is an unknown property
          -webkit-text-size-adjust: 100%; /* 2 */
      -----------------------------^	Linked-in stylesheet	normalize.css:70
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:154
            -webkit-appearance is an unknown property
          -webkit-appearance: button; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:329
            -webkit-appearance is an unknown property
          -webkit-appearance: textfield; /* 1 */
      -----------------------^	Linked-in stylesheet	normalize.css:360
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:361
            -webkit-box-sizing is an unknown property
          -webkit-box-sizing: content-box; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:362
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-cancel-button,
      --------------------------------------------------^	Linked-in stylesheet	normalize.css:371
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-decoration {
      -----------------------------------------------^	Linked-in stylesheet	normalize.css:372
            -webkit-appearance is an unknown property
          -webkit-appearance: none;
      -----------------------^	Linked-in stylesheet	normalize.css:373
            "::" not followed by known pseudo element
      button::-moz-focus-inner,
      ------------------------^	Linked-in stylesheet	normalize.css:380
            "::" not followed by known pseudo element
      input::-moz-focus-inner {
      -----------------------^	Linked-in stylesheet	normalize.css:381
            Unknown pseudo class
      *,:x
      ----^	HTML style attribute	HTML style attribute:1
            Invalid value for property: zoom
      border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1
      -------------------------------------------------------------^	HTML style attribute	auth:1
            Invalid value for property: zoom
      1
      -^	DOM style property	auth:1
            text-wrap is an unknown property
      text-wrap: none
      ----------^	HTML style attribute	en:1
            -ms-text-size-adjust is an unknown property
          -ms-text-size-adjust: 100%; /* 2 */
      -------------------------^	Linked-in stylesheet	normalize.css:69
            -webkit-text-size-adjust is an unknown property
          -webkit-text-size-adjust: 100%; /* 2 */
      -----------------------------^	Linked-in stylesheet	normalize.css:70
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:154
            -webkit-appearance is an unknown property
          -webkit-appearance: button; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:329
            -webkit-appearance is an unknown property
          -webkit-appearance: textfield; /* 1 */
      -----------------------^	Linked-in stylesheet	normalize.css:360
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:361
            -webkit-box-sizing is an unknown property
          -webkit-box-sizing: content-box; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:362
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-cancel-button,
      --------------------------------------------------^	Linked-in stylesheet	normalize.css:371
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-decoration {
      -----------------------------------------------^	Linked-in stylesheet	normalize.css:372
            -webkit-appearance is an unknown property
          -webkit-appearance: none;
      -----------------------^	Linked-in stylesheet	normalize.css:373
            "::" not followed by known pseudo element
      button::-moz-focus-inner,
      ------------------------^	Linked-in stylesheet	normalize.css:380
            "::" not followed by known pseudo element
      input::-moz-focus-inner {
      -----------------------^	Linked-in stylesheet	normalize.css:381
            Invalid value for property: white-space
          white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
      ------------------------------------------^	Linked-in stylesheet	application.css:66
            Invalid value for property: white-space
          white-space: -o-pre-wrap;    /* Opera 7 */
      -----------------------------^	Linked-in stylesheet	application.css:67
            word-break is an unknown property
          word-break: break-all;
      ---------------^	Linked-in stylesheet	application.css:70
            Unknown pseudo class
      *,:x
      ----^	HTML style attribute	HTML style attribute:1
            Invalid value for property: zoom
      border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1
      -------------------------------------------------------------^	HTML style attribute	en:1
            Invalid value for property: zoom
      1
      -^	DOM style property	en:1
            text-wrap is an unknown property
      text-wrap: none
      ----------^	HTML style attribute	en:1
            Invalid value for property: white-space
          white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
      ------------------------------------------^	Linked-in stylesheet	application.css:67
            Invalid value for property: white-space
          white-space: -o-pre-wrap;    /* Opera 7 */
      -----------------------------^	Linked-in stylesheet	application.css:68
            word-break is an unknown property
          word-break: break-all;
      ---------------^	Linked-in stylesheet	application.css:73
            Unknown pseudo class
      *,:x
      ----^	HTML style attribute	HTML style attribute:1
            -ms-text-size-adjust is an unknown property
          -ms-text-size-adjust: 100%; /* 2 */
      -------------------------^	Linked-in stylesheet	normalize.css:69
            -webkit-text-size-adjust is an unknown property
          -webkit-text-size-adjust: 100%; /* 2 */
      -----------------------------^	Linked-in stylesheet	normalize.css:70
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:154
            -webkit-appearance is an unknown property
          -webkit-appearance: button; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:329
            -webkit-appearance is an unknown property
          -webkit-appearance: textfield; /* 1 */
      -----------------------^	Linked-in stylesheet	normalize.css:360
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:361
            -webkit-box-sizing is an unknown property
          -webkit-box-sizing: content-box; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:362
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-cancel-button,
      --------------------------------------------------^	Linked-in stylesheet	normalize.css:371
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-decoration {
      -----------------------------------------------^	Linked-in stylesheet	normalize.css:372
            -webkit-appearance is an unknown property
          -webkit-appearance: none;
      -----------------------^	Linked-in stylesheet	normalize.css:373
            "::" not followed by known pseudo element
      button::-moz-focus-inner,
      ------------------------^	Linked-in stylesheet	normalize.css:380
            "::" not followed by known pseudo element
      input::-moz-focus-inner {
      -----------------------^	Linked-in stylesheet	normalize.css:381
            Invalid value for property: zoom
      border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1
      -------------------------------------------------------------^	HTML style attribute	en:1
            Invalid value for property: zoom
      1
      -^	DOM style property	en:1
            text-wrap is an unknown property
      text-wrap: none
      ----------^	HTML style attribute	gifts:1
            Invalid value for property: white-space
          white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
      ------------------------------------------^	Linked-in stylesheet	application.css:67
            Invalid value for property: white-space
          white-space: -o-pre-wrap;    /* Opera 7 */
      -----------------------------^	Linked-in stylesheet	application.css:68
            word-break is an unknown property
          word-break: break-all;
      ---------------^	Linked-in stylesheet	application.css:73
            Unknown pseudo class
      *,:x
      ----^	HTML style attribute	HTML style attribute:1
            -ms-text-size-adjust is an unknown property
          -ms-text-size-adjust: 100%; /* 2 */
      -------------------------^	Linked-in stylesheet	normalize.css:69
            -webkit-text-size-adjust is an unknown property
          -webkit-text-size-adjust: 100%; /* 2 */
      -----------------------------^	Linked-in stylesheet	normalize.css:70
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:154
            -webkit-appearance is an unknown property
          -webkit-appearance: button; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:329
            -webkit-appearance is an unknown property
          -webkit-appearance: textfield; /* 1 */
      -----------------------^	Linked-in stylesheet	normalize.css:360
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:361
            -webkit-box-sizing is an unknown property
          -webkit-box-sizing: content-box; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:362
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-cancel-button,
      --------------------------------------------------^	Linked-in stylesheet	normalize.css:371
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-decoration {
      -----------------------------------------------^	Linked-in stylesheet	normalize.css:372
            -webkit-appearance is an unknown property
          -webkit-appearance: none;
      -----------------------^	Linked-in stylesheet	normalize.css:373
            "::" not followed by known pseudo element
      button::-moz-focus-inner,
      ------------------------^	Linked-in stylesheet	normalize.css:380
            "::" not followed by known pseudo element
      input::-moz-focus-inner {
      -----------------------^	Linked-in stylesheet	normalize.css:381
            Invalid value for property: zoom
      border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1
      -------------------------------------------------------------^	HTML style attribute	gifts:1
            Invalid value for property: zoom
      1
      -^	DOM style property	gifts:1
            text-wrap is an unknown property
      text-wrap: none
      ----------^	HTML style attribute	gifts:1
            Invalid value for property: white-space
          white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
      ------------------------------------------^	Linked-in stylesheet	application.css:67
            word-break is an unknown property
          word-break: break-all;
      ---------------^	Linked-in stylesheet	application.css:72
            Unknown pseudo class
      *,:x
      ----^	HTML style attribute	HTML style attribute:1
            -ms-text-size-adjust is an unknown property
          -ms-text-size-adjust: 100%; /* 2 */
      -------------------------^	Linked-in stylesheet	normalize.css:69
            -webkit-text-size-adjust is an unknown property
          -webkit-text-size-adjust: 100%; /* 2 */
      -----------------------------^	Linked-in stylesheet	normalize.css:70
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:154
            -webkit-appearance is an unknown property
          -webkit-appearance: button; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:329
            -webkit-appearance is an unknown property
          -webkit-appearance: textfield; /* 1 */
      -----------------------^	Linked-in stylesheet	normalize.css:360
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:361
            -webkit-box-sizing is an unknown property
          -webkit-box-sizing: content-box; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:362
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-cancel-button,
      --------------------------------------------------^	Linked-in stylesheet	normalize.css:371
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-decoration {
      -----------------------------------------------^	Linked-in stylesheet	normalize.css:372
            -webkit-appearance is an unknown property
          -webkit-appearance: none;
      -----------------------^	Linked-in stylesheet	normalize.css:373
            "::" not followed by known pseudo element
      button::-moz-focus-inner,
      ------------------------^	Linked-in stylesheet	normalize.css:380
            "::" not followed by known pseudo element
      input::-moz-focus-inner {
      -----------------------^	Linked-in stylesheet	normalize.css:381
            Invalid value for property: zoom
      border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1
      -------------------------------------------------------------^	HTML style attribute	gifts:1
            Invalid value for property: zoom
      1
      -^	DOM style property	gifts:1
            text-wrap is an unknown property
      text-wrap: none
      ----------^	HTML style attribute	gifts:1
            Invalid value for property: white-space
          white-space: -moz-pre-wrap !important;  /* Mozilla, since 1999 */
      ------------------------------------------^	Linked-in stylesheet	application.css:67
            word-break is an unknown property
          word-break: break-all;
      ---------------^	Linked-in stylesheet	application.css:72
            Unknown pseudo class
      *,:x
      ----^	HTML style attribute	HTML style attribute:1
            -ms-text-size-adjust is an unknown property
          -ms-text-size-adjust: 100%; /* 2 */
      -------------------------^	Linked-in stylesheet	normalize.css:69
            -webkit-text-size-adjust is an unknown property
          -webkit-text-size-adjust: 100%; /* 2 */
      -----------------------------^	Linked-in stylesheet	normalize.css:70
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:154
            -webkit-appearance is an unknown property
          -webkit-appearance: button; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:329
            -webkit-appearance is an unknown property
          -webkit-appearance: textfield; /* 1 */
      -----------------------^	Linked-in stylesheet	normalize.css:360
            -moz-box-sizing is an unknown property
          -moz-box-sizing: content-box;
      --------------------^	Linked-in stylesheet	normalize.css:361
            -webkit-box-sizing is an unknown property
          -webkit-box-sizing: content-box; /* 2 */
      -----------------------^	Linked-in stylesheet	normalize.css:362
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-cancel-button,
      --------------------------------------------------^	Linked-in stylesheet	normalize.css:371
            "::" not followed by known pseudo element
      input[type="search"]::-webkit-search-decoration {
      -----------------------------------------------^	Linked-in stylesheet	normalize.css:372
            -webkit-appearance is an unknown property
          -webkit-appearance: none;
      -----------------------^	Linked-in stylesheet	normalize.css:373
            "::" not followed by known pseudo element
      button::-moz-focus-inner,
      ------------------------^	Linked-in stylesheet	normalize.css:380
            "::" not followed by known pseudo element
      input::-moz-focus-inner {
      -----------------------^	Linked-in stylesheet	normalize.css:381
            Invalid value for property: zoom
      border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1
      -------------------------------------------------------------^	HTML style attribute	gifts:1
            Invalid value for property: zoom
      1
      -^	DOM style property	gifts:1

147) old invalid flash in ajax injected into gifts/index page
     "Opslag opretter her og på din facebook væg. Foto blev uploaded til din facebook væg, men Gofreerev mangler rettigheder til at se billedet på din facebook væg og kan derfor ikke vise foto herinde. Måske du har ændret rettighedsindstillinger for Gofreerev."
     key fb_pic_post_unknown_problem
     problem is in get_api_picture_url_facebook
     called from /util/missing_api_picture_urls.js
     should only check pictures - should not ajax inject error messages into gifts/index page
     error message could come already when posting on wall
     not after next refresh page

148) check css errors in other browsers.

149) firefox :
        19:00:50.986 Use of getUserData() or setUserData() is deprecated.  Use WeakMap or element.dataset instead. requestNotifier.js:64
        19:00:51.350 Error in parsing value for 'white-space'.  Declaration dropped. application.css:67
        19:00:51.350 Error in parsing value for 'white-space'.  Declaration dropped. application.css:68
        19:00:51.481 Unknown property 'box-sizing'.  Declaration dropped. normalize.css:155
        19:00:51.481 Unknown property 'box-sizing'.  Declaration dropped. normalize.css:349
        19:00:51.481 Unknown property 'box-sizing'.  Declaration dropped. normalize.css:363
        19:00:51.481 Unknown pseudo-class or pseudo-element '-webkit-search-cancel-button'.  Ruleset ignored due to bad selector. normalize.css:371
        19:00:52.065 Unknown property 'text-wrap'.  Declaration dropped. gifts

150) opera 12: A page on the public internet requests data from your private intranet. For security reasons, automatic access is blocked, but you may choose to continue.
     problem is not in opera 19 on windows.
     opera:config#Network|AllowCrossNetworkNavigation

151) cross browser check:
     https://spoon.net/browsers/
     IE8 - checking now

153) IE8: getElementsByClassName is not supported.
     Use document.querySelectorAll('.overflow)
     check js code for getElementsByClassName usage.
     if (document.getElementsByClassName) divs = document.getElementsByClassName('overflow') ;
     else divs = document.querySelectorAll('.overflow') ;


154) IE8: there is a problem with main menu in IE 8.
     both 1 and 2 lines menu is shown.

155) IE8 is downloading gifts.js after post new gift
     Gift is posted but no message about post in top of gifts/index page
     It must be a problem in post ajax / ajax:success handling. Check log.
     same problem for add comment.
     added format.js { render :content_type => "text/javascript" }
     ok if answering yes to download (and execute) js file
     gift and comment links work ok (also post links)
     check difference in post gift/comment and post links
     maybe the difference is remote submit form / remote submit link

156) IE8: new gift submit bottom is not disabled. check if double post are possible from IE8.

157) deleted comments is included in "show-older-comments" count

158) show older comments link gives error for deleted comments
     a) only ajax for first gift. solved now
     b) no error message in gifts/index page
     c) @api_gift is not setted in comments/index - required in api_comments3
        check how api_gift is selected in gifts/index page. see User.api_gifts
        # multiple logins - find and remove any doublet gifts
        # priority:
        # 1) sort by status_update_at desc (also order by condition in select statement)
        # 2) closed gift before open gift
        # 3) api gift with picture
        # 4) api picture url with error and creator of gift in login_users - recheck picture with login user privs.
        # 5) api gift without picture
        ags = ags.sort do |a, b|
          if b.gift.status_update_at != a.gift.status_update_at
            # 1) keep sort by status_update_at desc (also order by condition in select statement)
            b.gift.status_update_at <=> a.gift.status_update_at
          elsif a.status_sort != b.status_sort
            a.status_sort <=> b.status_sort # 2) closed gift before open gift
          else
            a.picture_sort(login_users) <=> b.picture_sort(login_users) # 3, 4 and 5
          end
        end # ags sort 1

159) gifts link and comments links
     use jquery "on" and delegated events: https://api.jquery.com/on/
     "bind" works only for existing elements in page
     are using unbind+bind after adding new rows
     could not get it to work for comment-action-link ajax

160) jquery signatures. found a "success: function (responseText, statusText, xhr, $form)"
     signature for #new_gift ajax handler (ajaxForm). $form[0] was form object.
     jquery .bind("ajax:success", function (evt, data, status, xhr) signature
     dump properties for all 4 parameters. Maybe there is a back reference to element that triggered the event.

162) check file upload in all browsers. ok in ie8

163) JS error handling. It would be nice with line number for JS errors.
     special a problem in old browsers (IE8)
     check http://stackoverflow.com/questions/1340872/how-to-get-javascript-caller-function-line-number-how-to-get-javascript-caller
     check https://github.com/stacktracejs/stacktrace.js

164) old browsers without media query support
     display elements for large screen - hide elements for small screens
     http://caniuse.com/css-mediaqueries
     ie8 does not support media query

165) make test check list. every test should be done in every supported browser.

166) ie8 target=blank opens in a new window and no shared cookie.
     could be a special spoon.net test problem - could be a reel problem with IE
