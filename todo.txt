 1) add date format. see application_helper.format_date

 2) api notifications:
    get a app access token.
    send only notifications to api if internal notifications in app is not read.
    Short summary of unread app notifications in api notification
    Only few api notifications and stop sending messages if user do not start app
    for example notification every 1, 2, 4, 7, 14, 28 day
    one notification every day if user connects to app.
    don't send any more notifications if user has not been connected for 28 days
    check out facebook, linkedin & twitter notification possibilities
    https://developers.facebook.com/docs/games/notifications/
    https://developers.facebook.com/docs/graph-api/reference/user/notifications/
    get application token:
      api_server = Koala::Facebook::RealtimeUpdates.new :app_id => API_ID[:facebook], :secret => API_SECRET[:facebook]
      api_server.app_access_token
      res = RestClient.post "https://graph.facebook.com/1705481075/notifications", :href => 'http://localhost/da/gifts', :template => 'this is a test', :access_token => api_server.app_access_token
      res == "{\"success\":true}"
      signature from FB notification:
      Started POST "/?fb_source=notification&fb_ref=friends_find&ref=notif&notif_t=app_notification" for 127.0.0.1 at 2014-04-02 07:48:09 +0200
      User Load (5.5ms)  SELECT "users".* FROM "users" WHERE (user_id in ('1705481075/facebook'))
      CACHE (0.1ms)  SELECT "users".* FROM "users" WHERE (user_id in ('1705481075/facebook'))
      Processing by FacebookController#create as HTML
      Parameters: {"signed_request"=>"6xbhSI-JNpGOf7Ye54gft7kF4Tmxdr0AQVA0Iy0hw34.eyJhbGdvcml0aG0iOiJITUFDLVNIQTI1NiIsImV4cGlyZXMiOjEzOTY0MjIwMDAsImlzc3VlZF9hdCI6MTM5NjQxNzY4Mywib2F1dGhfdG9rZW4iOiJDQUFGalpCR3p6T2tjQkFQUGoyakJtVTc2UkxkODFjcG0xSTVqMDlZcWNZNjFSOFRwYnRoa3l0QlNkb0JoalNrQWh0UFBhaTN3VmlCekZRM2dsb1pCVUtxTVhXV0tlTkVqeVk3U2pOTXJRZXUzWkI4MVRoVEhwTEtBZzMyRzlLaVpCaFpCR1pBbEdROFpBQThnN3R5aDZVREpRS0pqY3dnek52djZqaE9lR00yUlUyTEk1MkZDWkFIZUJaQWdSWVVWZXVTRHNzamdrYjVKcTNBWkRaRCIsInVzZXIiOnsiY291bnRyeSI6ImRrIiwibG9jYWxlIjoiZW5fR0IiLCJhZ2UiOnsibWluIjoyMX19LCJ1c2VyX2lkIjoiMTcwNTQ4MTA3NSJ9",
                   "fb_locale"=>"en_GB", "fb_source"=>"notification", "fb_ref"=>"friends_find",
                   "ref"=>"notif", "notif_t"=>"app_notification"}
    - added FB app notifications for friends find

 3) add accept conditions for new users?

 4) recalculate user balance at request or once every day

 5) user.recalculate_balance recalculates balance for all closed deals with user as giver or receiver.
    ok when few closed deals for a user, but can be a performance issue with many closed deals for a user.
    allow recalculating balance from a specific date or from a specific gift.id
    should only recalculate balance from last closed deal

 7) check texts in views/fb/create.html.erb and create_da_html.erb

 9) check todo's in source

11) find some way to combine or group "identical" notifications in inbox/index page

12) stress test. make a db with really many rows and test performance.
    There maybe are missing an index or two
    there maybe are some sql that should be rewritten
    performance issues are different in sqlite3 and in mysql
    move development db to mysql before test
    db_load fails with import errors
    https://github.com/ludicast/yaml_db
    https://github.com/ludicast/yaml_db/pull/45
    second try - make an new mysql database for stress test

13) check session variables
    session variables should only be used from accessor methods in app. controller
    gives a better overview and an easier to maintain code

14) tests - needs new users.yml file - encryption now is with old userids

15) test case:
    create deal [ a.provider1, a.provider2] as giver, [ b.provider1, b.provider2 ] as receiver, price > 0
    login as a.provider1 and b.provider2
    problem with user/show balance. logged users are giver and receiver at the same time
    must be displayed as 0 in balance
    check code with [ag.user_id_giver, ag.user_id_receiver].index(user_id)
    check code with login_user_ids.index(ag.user_id_giver)
    check code with api_gift = api_gifts.find { |ag| [ ag.user_id_giver, ag.user_id_receiver].index(???)

17) add mysql development environment on localhost.
    there some are minor difference between using sqlite3 and mysql as db
    a) problem with "" around table names in mysql
    b) Less float precession in mysql than in sqlite3

19) check notifications and change notification test cases to support multiple logins

20) better github page

21) links on app setup pages to github page (wiki, report bugs etc)
    check app setup for facebook, google+, linkedin and twitter

22) post on linkedin from localhost
    can not upload picture with localhost url to linkedin
    add a special error message for this case?

24) add server site cleanup for api_gifts with temp url
    created in gifts/create - removed in util.delete_local_picture after post_on_<provider> tasks

25) check if user div onclick events could be handled on a higher level - for example on document
    can not use user_id in id. user divs are repeated many times for each user.
    use data-id attribute for user.id
    use jquery "on" and delegated events: https://api.jquery.com/on/

26) link from post on gofreerev to post on facebook but only if FB friend
    link from post on gofreerev to post on linkedin but only if LinkedIn connection
    should have small API icons for each post.
    multiple icons if multiple logins and post in multiple API's

27) check response from FastImage.type(gift_file.path) if site is temporary unavailable
    should not error mark pictures if a api picture server is temporary out of service
    FastImage.type returns nil if server is temporary unavailable
    Must combine FastImage = nil with a http get page notfound check
    http://stackoverflow.com/questions/2695020/how-can-i-use-ruby-to-check-if-a-domain-exists

29) deal proposal and changed friend relations
    cancel deal proposal when friends are removed
    could be remove friends in users/index page
    could be changed api friend relation in post login provider task

30) jquery. url from xhr object is used to find html element that triggered the ajax event
    for example to setup tables for ajax error messages within gifts/index page
    it could be nice if jquery has information about the html element that started the ajax request
    $(classname).bind('click', function ... - find id for html element with classname with triggered this bind handler
    jquery signatures. found a "success: function (responseText, statusText, xhr, $form)"
    signature for #new_gift ajax handler (ajaxForm). $form[0] was form object.
    jquery .bind("ajax:success", function (evt, data, status, xhr) signature
    dump properties for all 4 parameters. Maybe there is a back reference to element that triggered the event.
    dump of a beforeSend xhr object:
    tasks_form_xhr.status = undefined
    tasks_form_xhr.statusText = undefined
    tasks_form_xhr.readyState = undefined
    tasks_form_xhr[type] = ajax:beforeSend
    tasks_form_xhr[timeStamp] = 1395056109867
    tasks_form_xhr[jQuery1110005057767523957335] = true
    tasks_form_xhr[isTrigger] = 3
    tasks_form_xhr[namespace] =
    tasks_form_xhr[namespace_re] = null
    tasks_form_xhr[result] = undefined
    tasks_form_xhr[target] = [object HTMLFormElement]
    tasks_form_xhr[delegateTarget] = [object HTMLDocument]
    tasks_form_xhr[currentTarget] = [object HTMLFormElement]
    tasks_form_xhr[handleObj] = [object Object]
    tasks_form_xhr[data] = undefined
    tasks_form_xhr[isDefaultPrevented] = function returnFalse() { return false; }
    tasks_form_xhr[isPropagationStopped] = function returnFalse() { return false; }
    tasks_form_xhr[isImmediatePropagationStopped] = function returnFalse() { return false; }
    tasks_form_xhr[preventDefault] = function () { var e = this.originalEvent; this.isDefaultPrevented = returnTrue; if ( !e ) { return; } // If preventDefault exists, run it on the original event if ( e.preventDefault ) { e.preventDefault(); // Support: IE // Otherwise set the returnValue property of the original event to false } else { e.returnValue = false; } }
    tasks_form_xhr[stopPropagation] = function () { var e = this.originalEvent; this.isPropagationStopped = returnTrue; if ( !e ) { return; } // If stopPropagation exists, run it on the original event if ( e.stopPropagation ) { e.stopPropagation(); } // Support: IE // Set the cancelBubble property of the original event to true e.cancelBubble = true; }
    tasks_form_xhr[stopImmediatePropagation] = function () { this.isImmediatePropagationStopped = returnTrue; this.stopPropagation(); }
    xhr.target and xhr.currentTarget looks interesting

31) new gift.status_update_at after new comments?
    In that way updated gifts will be at top of page and will be ajax injected to top of page
    how to keep actual user view point when ajax injecting new rows in top of page?

32) edit user options
    - cross provider balance y/n checkbox
    - share balance

33) a number of "invalid" inbox notification keys. Could be missing keys. Could be wrong notifications

    missing translate key. key .accepted_proposal_giver_follow_2_v1_to_url, noti.id 542,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Gofreerev A", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_follow_2_v1_to_url

    missing translate key. key .accepted_proposal_giver_follow_2_v1_to_msg, noti.id 542,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Gofreerev A", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_follow_2_v1_to_msg

    Notification 542 to 100006397022113/facebook Charlie S

    1) gift 894
       created Fri, 24 Jan 2014 10:35:02 UTC +00:00
       created by givers 100006399422155/facebook Sandra Q, 109316109373670614208/google_oauth2 and 2179784783/twitter Jan R
    2) new deal proposal comment id 754
       created 2014-01-24 10:35:19
       created by 100006397022113/facebook Charlie S
    3) accept deal proposal comment id 754
       accepted 2014-01-24 10:35:37
       accepted by 100006399422155/facebook Sandra Q


    giver = 100006399422155/facebook Sandra Q,               receiver = 100006397022113/facebook Charlie S
    giver = 109316109373670614208/google_oauth2 Gofreerev A, receiver = gofreerev/google_oauth2 Gofreerev G
    giver = 2179784783/twitter Jan R,                        receiver = gofreerev/twitter Gofreerev T
    Deal between Sandra Q and Charlie S - dummy receivers for google+ and twitter

    Notification 541 :

    ============================================================================

    missing translate key. key .accepted_proposal_giver_2_v1_to_url, noti.id 541,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Sandra Q", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_2_v1_to_url

    missing translate key. key .accepted_proposal_giver_2_v1_to_msg, noti.id 541,
    options {:giftid=>"894", :gifttext=>"x", :no_users=>"2", :no_other_users=>"0", :username1=>"Gofreerev A", :username2=>"Jan R", :username3=>"", :givername=>"Sandra Q", :receivername=>""},
    error translation missing: en.inbox.index.accepted_proposal_giver_2_v1_to_msg

    missing translate key. key .new_comment_giver_follow_1_v1_from_url, noti.id 341,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_url

    missing translate key. key .new_comment_giver_follow_1_v1_from_msg, noti.id 341,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_msg

    missing translate key. key .new_comment_giver_follow_1_v1_from_url, noti.id 340,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_url

    missing translate key. key .new_comment_giver_follow_1_v1_from_msg, noti.id 340,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_msg

    missing translate key. key .new_comment_giver_follow_1_v1_from_url, noti.id 339,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_url

    missing translate key. key .new_comment_giver_follow_1_v1_from_msg, noti.id 339,
    options {:giftid=>"425", :gifttext=>"e", :no_users=>"1", :no_other_users=>"-1", :username1=>"Charlie S", :username2=>"", :username3=>"", :givername=>"", :receivername=>""},
    error translation missing: en.inbox.index.new_comment_giver_follow_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 297,
    options {:giftid=>"265", :gifttext=>"accept test 12", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 297,
    options {:giftid=>"265", :gifttext=>"accept test 12", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 293,
    options {:giftid=>"263", :gifttext=>"accept test 10", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 293,
    options {:giftid=>"263", :gifttext=>"accept test 10", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 277,
    options {:giftid=>"255", :gifttext=>"test accept 2", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 277,
    options {:giftid=>"255", :gifttext=>"test accept 2", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 275,
    options {:giftid=>"254", :gifttext=>"test accept", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 275,
    options {:giftid=>"254", :gifttext=>"test accept", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

    missing translate key. key .accepted_proposal_giver_1_v1_from_url, noti.id 273,
    options {:giftid=>"253", :gifttext=>"Cykel", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_url

    missing translate key. key .accepted_proposal_giver_1_v1_from_msg, noti.id 273,
    options {:giftid=>"253", :gifttext=>"Cykel", :no_users=>"0", :no_other_users=>"-2", :username1=>"", :username2=>"", :username3=>"", :givername=>"Charlie S", :receivername=>"Karen S"},
    error translation missing: en.inbox.index.accepted_proposal_giver_1_v1_from_msg

38) add language LOV to page header if width > xxx

39) gift giver pic mouse over text should have information about multiple provider givers
    gift receiver pic mouse over text should have information about multiple provider receivers

40) google+ and twitter.
    how to prevent friend invitations from people you do not know?
    F - you are following someone on google+ and twitter, and do not want to receive friend invitations from them
    S - you are stalked by someone on google+ and twitter and do not want to receive friend invitations from them
    block all and allow selected users
    allow all and block selected users

43) User.api_gifts
    maybe problem with very big select if really many friends for logged in users
    on other option could be 2 sub queries combined with filter for deselected friends
    select * from api_gifts
    where user_id_giver in (select ...) and user_id_giver not in (1,2,3, ..)
    or    user_id_receiver in (select ...) and user_id_receiver not in (1,2,3, ..)

45) check out JS API's for login providers. most interesting are readonly API's (google+ and instagram)
    some not supported server site operations could be implemented with client side JS

46) users/index - friends of friends - why in list - show name(s) of friend
    maybe the same issue as in previous dropped mutual friends

47) find a better location for ajax tasks spinner in top of page
    show/hide spinner makes the page bouncing
    add mouse over title to ajax tasks title with explanation.
    maybe after ".create_gift_header_line"
    Maybe under ".description_prompt"

48) add mini spinners for some time consuming tasks.
    for example deleting a closed deal (recalculate balance)

49) users/index: search, friend name filter or alphabetical tabs
    it is slowly to scroll down (3 seconds delay for each 10 rows lookup)

50) running ajax tasks and http links - for example link to other page
    error. more information in server log" and ajax spinner is hidden
    should hide ajax error message and maybe not hide ajax spinner
    an other solution could be showing spinner after click on link

51) opera 12.16 bug when gofreerev starts from facebook https://apps.facebook.com/gofreerev-dev/
    Warning
    https://dev1.gofreerev.com/
    A page on the public internet requests data from your private intranet.
    For security reasons, automatic access is blocked, but you may choose to continue.
    Continue
    Always continue when data is requested from this server on my private intranet
    Generated by Opera.
    Only problem in first https://apps.facebook.com/gofreerev-dev/ request => get /
    Second https://apps.facebook.com/gofreerev-dev/ request => post /
    Opera console does not reveal any rejected localhost requests. But should not start with a "get /" in log

53) localhost / login servers Sandra/fb and Gofreerev A/gp
    2+2 notifications. 2 accepted and 2 accepted follow notification.
    for example 13. feb. 2014 11.58
    should only send notification to Sandra+Gofreerev as creator of proposal.
    should not send notification to Sandra+Gofreerev as follower of proposal.
    the same pattern for "outbox" for Jan R/google+ as sender of message.
    also 13. feb. 2014 11.58

55) how to check for an "official" gofreerev version
    easy to copy gofreerev and misuse the concept (harvest user information from API's)
    maybe a list of officiel gofreerev sites

56) users/index apiname=<provider> filter. Use login user = selected provider.
    in that way all user dev pictures are from the same login provider.

58) find all methods with case provider ... implementations. Should be listed in todo for adding a new login provider.
    maybe add a special search word that can be used to find all relevant points in source code when adding a new login provider
    add "API SETUP" comment for all case provider statements

59) users/index friends filter: add follows and followed by filters?

60) auth/index page
    - add * note for login providers that does not support post on wall
    - add missing provider? note. add a github page with request for missing login providers

 62) linkedin gem. frozen to an old version due to error. Unfreeze when error is solved
     https://github.com/hexgnu/linkedin/issues/216

 64) refactor linkedin & flickr controller translate keys into shared? Almost identical translations

 66) check out open graph meta-tags in flickr.
     maybe some that could by used
     <meta property="fb:app_id" content="137206539707334" />    x
     <meta property="og:title" content="u6bbc6h8oy" />
     <meta property="og:type" content="flickr_photos:photo" />
     <meta property="og:url" content="http://www.flickr.com/photos/gofreerev/12593199523/" />
     <meta property="og:site_name" content="Flickr" />
     <meta property="twitter:card" content="photo" />
     <meta property="twitter:site" content="@flickr" />
     <meta property="og:description" content="localhost/da/gifts/VyGiwGM7NXQ1JzBA2XAj1VV5zeGEtb" />
     <meta property="og:image" content="https://farm4.staticflickr.com/3716/12593199523_7600c19134_z.jpg" />
     <meta property="og:image:width" content="514" />
     <meta property="og:image:height" content="640" />
     <meta property="flickr_photos:by" content="http://www.flickr.com/people/gofreerev/" />
     <meta property="twitter:description" content="localhost/da/gifts/VyGiwGM7NXQ1JzBA2XAj1VV5zeGEtb" />

 68) two or three column friend list in users/index page.
     responsive design or use javascript to organize table layout
     could use float divs in a multi column users/index page
     that is fixed width, height and fixed table column size
     number of users in http/ajax requests should match number of columns.
     2 columns: get 2 friends in first request - get 20 friends in next request
     3 columns: get 3 friends in first request - get 30 friends in next request
     problems with show-more-rows functionality?

 69) post on twitter: Exception: execution expired (Twitter::Error) after 6 seconds
     added exception to post on twitter for debug
     maybe a generic way to handle execution expired when posting on api walls
     repeat up to 3 times before giving up
     return warning to user and try once more time
     delete_local_picture task and expired post on wall exception!

 70) localhost - looking af gift id 909 logged in as Jan R/FB
     from user div ok = me
     to user div = dummy FB user gofreerev/facebook
     that is no information about google+ receiver 109316109373670614208/google_oauth2 Gofreerev A
     irb(main):009:0> [ g.api_gifts[0].giver.debug_info, g.api_gifts[0].receiver.debug_info ]
     => ["1705481075/facebook Jan R", "gofreerev/facebook Gofreerev F"]
     irb(main):010:0> [ g.api_gifts[1].giver.debug_info, g.api_gifts[1].receiver.debug_info ]
     => ["117657151428689087350/google_oauth2 Jan R", "109316109373670614208/google_oauth2 Gofreerev A"]
     also a comments from 100006399422155/facebook Sandra Q
     can not se that comments also was from 109316109373670614208/google_oauth2 Gofreerev A
     Not necessarily a problem as users normally will use there real names, but can be a problem in test

 72) view: add timestamps to comments?

 74) add a JS text length counter when entering text. Twitter users would like to known how long the text is.
     special problem for twitter where 23 characters is subtracted from 140 for links and for images.
     one "<n> remaining characters" counter for each provider with post on wall selected and authorized?

 75) api_profile_picture_url with small (50x50) and big (100x100) pictures.
     100x100 (5246 bytes) is only used in users/index and users/show
     50x50   (1744/2877 bytes) is used everywhere else
     can make a difference on a slow connection / slow device

 77) distribute option:
     find friends / see gifts on other gofreerev servers
     user-a id api friend with user-b, user-a is on server-a and user-b on server-b.
     user-a should be allowed to see user-b's gifts on server b
     user-b should be allowed to see user-a's gifts on server a

 78) ruby profiler. It could be nice with a good ruby profiler statistic.
     http://hiltmon.com/blog/2012/02/27/quick-and-dirty-rails-performance-profiling/
     https://github.com/ruby-prof/ruby-prof
     http://david.paluy.org/blog/2013/04/09/profiling-rails-applications/

 79) collect and organize screen dumps

 84) css wrapword. word-break: break-all;.
     works fine on small width screens but do not look nice on wide screens.
     there is implemented a workaround for opera 12 (that does not support break-all).
     it could be nice to avoid break-all on wide screens but there would still be a problems with long texts without spaces
     a possibility could be hyphenator to insert soft hyphen into text: https://code.google.com/p/hyphenator/

 85) problem with ie10 new gift with very large text.
     submit bottom is moved under text area on wide pc screen

 86) auto-remove max height if text if only a bit higher than max height

 88) old invalid flash in ajax injected into gifts/index page
     "Opslag opretter her og på din facebook væg. Foto blev uploaded til din facebook væg, men Gofreerev mangler rettigheder til at se billedet på din facebook væg og kan derfor ikke vise foto herinde. Måske du har ændret rettighedsindstillinger for Gofreerev."
     key fb_pic_post_unknown_problem
     problem is in get_api_picture_url_facebook
     called from /util/missing_api_picture_urls.js
     should only check pictures - should not ajax inject error messages into gifts/index page
     error message could come already when posting on wall
     not after next refresh page

 91) opera 12: A page on the public internet requests data from your private intranet.
     For security reasons, automatic access is blocked, but you may choose to continue.
     problem is not in opera 19 on windows.
     opera:config#Network|AllowCrossNetworkNavigation

 92) gifts link and comments links
     use jquery "on" and delegated events: https://api.jquery.com/on/
     "bind" works only for existing elements in page
     are using unbind+bind after adding new rows
     could not get it to work for comment-action-link ajax

 93) JS error handling. It would be nice with line number for JS errors.
     special a problem in old browsers (IE8)
     check http://stackoverflow.com/questions/1340872/how-to-get-javascript-caller-function-line-number-how-to-get-javascript-caller
     check https://github.com/stacktracejs/stacktrace.js

 94) make test check list. every test should be done in every supported browser.

 95) ie8 target=blank opens in a new window and no shared cookie.
     could be a special spoon.net test problem - could be a reel problem with IE
     ( test: use windows xp on virtualbox http://10.0.2.2 )


 96) check if there is any virtual machines available for test
     cannot test latest safari browsers from soon.net

 98) nice to have: decrease number of older comments in show older comments link if older comments has been deleted
     hard to implement without ajax replacing gift in gifts/index page

 99) there is a little problem with ajax replace new gift after new gift has been created
     problem is that user could be entering a new comment and that this new unsaved comment will be removed
     testcase: create new gift and start adding a comment for new gift - will be deleted in next new_messages_count request

100) fix scroll page scroll after new comment
     see scroll store and restore in JS post_ajax_add_new_comment_handler
     new comment should always be within actual view

101) entering new comment + click on menu link - no leave page yes/no dialog box
     entering new gift + click on menu link - no leave page yes/no dialog box
     maybe a generic solution - check solution for currency LOV

102) ie8 problem - new comment with very large text
     first click - resized to a smaller text area with scroll bars
     second click - submitted ok
     not a problem for new gift with very large text - what is the difference?
     ( test: use windows xp on virtualbox http://10.0.2.2 )

103) my.js - clear_ajax_errors(table_id) and clear_flash_and_ajax_errors
     clear all ajax error messages in web page
     add hidden timestamps to errors tables - ok
     add class for error tables - ajax_errors added
     add cleanup for old error messages
     timestamp column is not copied from tasks_errors2 to tasks_errors table (retest - maybe it was a client side JS message)
     timestamp column ok in show-more-rows-error table

104) fix sort when creating new comments in gifts/index page
     looks like character sort - must be number sort (gift id and comment id)
     fixed when creating new comments
     test ajax inject gifts and comments from other users into gifts/index page

105) reject_new_deal: reject link was removed - accept link was not removed

106) reject_new_deal: line with comment error message (proposal was rejected)
     is not removed when comment is ajax replaced with new comment from util.new_messages_count

108) controllers. add http/ajax comment to all relevant methods

109) controllers. check format_response in end of all ajax methods

110) ie8 - all tables must have a tbody and tbody must be used in ajax inject
     ( test: use windows xp on virtualbox http://10.0.2.2 )

112) check startup page size
     http://www.version2.dk/artikel/mobilsiderne-bliver-stoerre-og-langsommere-56847
     tools for faking a slow internet connection?
     http://www.ginktage.com/2013/11/tools-for-the-developers-to-simulate-slow-internet-connection/
     gifts/index - 20 kb
     users/index - 27 kb
     - long almost identical mail invite friends mailto texts.
     - http://stackoverflow.com/questions/9014470/creating-email-link-with-dynamically-generated-body-with-html5-javascript

113) test javascript csv_invalid_price - check price check in all browser versions (error in chrome has been fixed)
     use https://spoon.net/ on an windows machine

114) cross server friends invite / friends search?
     in a distributed server network different friends will use different servers and gofreerev apps

115) add hide link for text/url?
     "Gift was posted in here and on your facebook wall but picture cannot be displayed.
      Allow Gofreerev to read posts on my facebook wall!"
      one solution could be to set post on wall = N
      but it is only a problem for post with pictures

116) ie8 and ie9 - cross site forgery when starting gofreerev from apps.facebook.com/gofreerev-dev
     ( test: use windows xp on virtualbox http://10.0.2.2 - but 10.0.2.2 is not allowed in facebook app setup )

117) opera 12 errors:
     page header:
     Javascript fejl ved tjek for nye beskeder. NotFoundError: Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node. (4,3).
     Javascript fejl ved indsættelse af nye kommentarer. NotFoundError: Failed to execute 'insertBefore' on 'Node': The node before which the new node is to be inserted is not a child of this node. (5,54).
     Fejl ved tjek for nye beskeder. error. Mere information i server log.
     added some more JS outputs to client side debug log

118) users/show balance tab.
     should show post for relevant user combination.
     but only if logged in for provider and friend with user
     should display ... rows for hidden posts. Not logged in as provider / not friend with user for this provider.
     should display "total row" if last post is hidden (not logged in as provider / not friend with user for this provider)

119) problem with show-more-rows pages and back bottom on browsers.
     last_row_id has been cleared. Error key shared.show_more_rows.last_row_id_invalid
     could force page reload when using back bottom in browser.

120) linkedin app invitation:
     https://developer.linkedin.com/documents/invitation-api
     but requires w_messages priv.

121) allow friends find without user_combination
     that will only work online and if other users have shared their accounts

122) check if there is some problems with friends cache for instagram:
     friend?: no friends cache was found for login user 1092213433/instagram gofreerev g

123) allow friends find without combined accounts and buffer search result for other user
     User A executes a friends find search with friends proposal B, C and D
     Buffer A as friends proposal for B, C and D (only if B, C and D is active app users)
     Include A in next friends find search for B, C and D
     Could use some extra column(s) in friends table as buffer
     There should also be a "not interested" or "read" link in friends find post
     Could use

124) first util.new_messages_count 1 minute after login (for friends find search)

125) better "friends find no rows" message.
     check last login date for shared accounts.
     user should login to refresh friends lists for other login providers

127) facebook grant write:
     "Your popup is too small to display this page. Please enlarge it to proceed.
     was displaying firebox console in bottom 1/3 of page
     must be a problem on all mobile devices!
     maybe it is only a problem in rest api - maybe JS api can be used
     maybe fake a bigger screen before calling facebook dialog
     check if there is a identical error messages on a smartphone

128) different share accounts title for:
     a) not logged in users
     b) single account logged in users
     c) multiple accounts logged in users

129) maybe a friends find version of app
     a) save access tokens for friend list refresh - maybe
     b) notifications for facebook and emails for the other api's

131) add share accounts options:
     0) not shared = blank
     1) share balance
     2) 1) + share friend lists
     3) 1) + 2) + save access token for offline friend list refresh
     4) 1) + 2) + 3) + single sign-on
     5) mixed sharing with 0), 1), 2), 3) and 4) user accounts
     change share accounts checkbox to a share accounts LOV

132) post_login_new_user: "Your friend list is ready. Please refresh page to see any posts from your friends."
     ok for single login users and gifts/index page.
     not ok for multi login users and auth/index page.

133) logged in with 7 shared accounts and 1 not shared account.
     should add not shared accounts to shared_accounts_list

134) auth/index: show/hide share accounts spinner while changing share accounts status

137) auth/index: share_level_lov and offline_access_checkbox are disabled after page refresh
     testcase firefox 30.0 : 1) change LOV or checkbox, 2) refresh page, 3) LOV is disabled
     tried a JS fix - save LOV disabled/readonly state at startup - restore LOV disabled/readonly state at reload - did not work

138) cannot change share_level from 3 to 4 if access token was read from database
     that is - only load access token from database if share level is 4

139) share level 3 and 4 login
     warning if one or more access tokens are about to expire
     for example within one week

141) add special single sign-on login message
     a) first single sign-on login with no expired access token
     b) first single sign-on login with one or more expired access tokens
     c) secondary single sign-on login - renew expired access token - no other expired access tokens
     d) secondary single sign-on login - renew expired access tokens - one or more expired access tokens
     e) likewise for share level 3 logins

142) could not get google+ login with online access to work (share level 0-2). offline access is always being used

145) ajax: missing "please wait" message when checking post on wall checkbox and active ajax task
     http: "please wait" (ajax_leave_page) is triggered by ajax event onbeforeunload and can not be used for checkboxes
     maybe not a big problem but current message for running task is cleared in page header when clicking on checkbox
     It could be nice if there is a to count number of running/pending ajax requests
     See window.onbeforeunload (my.js) and JS error message js.general.ajax_leave_page

148) auth/index. drop checkbox for offline_access_yn.
     many users will forget to check checkbox
     but is should be very clear that auth. information is saved on server for share level 3 and 4

150) change currency. Text "clear_ajax_errors('show-more-rows-errors') ;" is ajax injected into page (firefox 30 on ubuntu).
     aside from this change currency works ok in page header and in user edit page

151) post in linkedin. comment (700 characters) in now only used for deep link
     but could also be used for generic description of Gofreerev
     see application_controller.open_graph_title_and_desc
     append generic description t("gifts.show.og_def_desc_#{api_gift.provider}") to comment

156) user/edit delete account.
     ajax spinner ok at first delete account request (logical delete account)
     ajax spinner is mising at second delete account request (physical delete account)

157) check http://developer.sharethis.com/Web_Share_API
     "Sharing is Caring. Get access to web services that provide comprehensive sharing capabilities to 120 social destinations"

158) add better html title for gifts. Special important for shared gifts with deep link where html title maybe is used on API's

159) add app.net as login provider.
     https://github.com/phuu/omniauth-appnet
     https://developers.app.net/reference/resources/app-stream/lifecycle/

160) share gift lov
     add scrollbar to LOV (http://www.codeproject.com/Questions/229885/how-to-make-scroll-bars-in-dropdown-list)

163) Mixed Content warning in firefox 30.0 om dev1 server
     problem is img http requests to image farms at api providers
     https://developer.mozilla.org/en-US/docs/Security/MixedContent
     could replace http with https if image farm supports https and has a valid ssl certificate

164) gifts/index create post.
     display field with providers where post on wall is selected and authorized so that user can see where gift is posted

167) util.get_api_picture_url_vkontakte
     better VK exception handling (now almost none)
     a) deleted picture
     b) authorization error
     c) other errors

168) util.get_api_picture_url_twitter
     better twitter exception handling
     a) deleted picture
     b) authorization error
     c) other errors

169) how to handle mouse over texts on touch screens
     http://www.paciellogroup.com/blog/2013/01/using-the-html-title-attribute-updated/
     http://stackoverflow.com/questions/12539006/tooltips-for-mobile-browsers
     http://jsfiddle.net/xaAN3/

170) check responsive design frameworks
     Se mails fra Jacob 2/10-2014
     1) Emne: Responsive design frameworks
     http://www.sitepoint.com/best-web-designing-frameworks-2014/
     http://gridgum.com/6-great-responsive-frameworks-for-2014/
     http://www.smashingmagazine.com/2014/02/19/responsive-design-frameworks-just-because-you-can-should-you/
     http://gumbyframework.com
     http://foundation.zurb.com
     http://responsive.vermilion.com/compare.php
     http://getbootstrap.com
     2) Emne: Flere widgets til Bootstrap
     http://exacttarget.github.io/fuelux/index.html
     3) Emne: VS: RATCHET
     Bootstraps eget mobil web site optimerede framework. Hvordan det passer med at Bootstrap kalder sig et mobil first responsive design framework ved jeg ikke.

174) google refresh token and offline access
     check if there is an issue with disconnected google+ accounts and renewal of access token
     for logged in users google+ access token is renewed once every hour without problems
     maybe there is a timeout issue for disconnected google+ users
     add batch process to auth renewal of access token for disconnected google+ users with share level 3 and 4?
     see application_controller.fetch_users

175) auth/index share account lov performance problem
     many user updates

176) exception in share on twitter:
     rescue in share_gift: Exception: undefined local variable or method `max_lng' for #<UtilController:0xb4ea7998> (NameError)
     rescue in share_gift: Backtrace: /mnt/plugdisk/railsapps/gofreerev-fb/releases/20141103080657/app/controllers/util_controller.rb:2903:in `share_gift'
     max_lng er undefined

group with issue 162, 177 and 178 ==>

162) Gofreerev share link url
     .../share/url=%{url}&text=%{text}&image_url=%{image_url}&close=#{boolean}
     could be like gifts/index page, but with an pre-filled field with image url
     normal params in share link urls (see js.share_gift.href_<provider>) are link and text. Normally not an image url
     should preview link and text before submit
     http://embedly.github.io/jquery-preview/demo/
     http://blog.embed.ly/post/45149972337/jquery-preview

177) allow link posts in Gofreerev.
     That is link + text in gift create and maybe also in comment create

178) allow url in create gift and create comment and add jquery preview functionality
     That is like link preview in facebook posts.
     To be used in issue 162) gofreerev share url functionality
     Also to be used in issue 177) url in gift and comment

group with issue 162, 177 and 178 <==

180) no exception mailer mail from ajax errors
     for example exception in post login

183) facebook is from oauth 2.0 a login only provider without friend list
     add other "no friend list" login providers
     can be used in single sign-on with providers with friend lists

187) Your app may break after 30 April 2015
     Some of the permissions below have not been approved for use by Facebook.
     was asking for read_stream priv. on localhost/laptop environment

188) support open graph post to facebook.
     https://developers.facebook.com/docs/graph-api/reference/v2.2/user/feed
     extra information for link: picture, name, caption, description
     without picture attachment - something like this
     api_response = api_client.put_connections('me', 'feed',
                                               :message => message, :picture => g.open_graph_image, :name => g.open_graph_title, :description => g.open_graph_description,
                                               :link => 'http://localhost/da/gifts/p6m3e3xrypfpmfrkaytm2yEocUbBYU', :caption => SITE_URL)
     use description from gift?

select next issue to solve: (rand*189).floor+1