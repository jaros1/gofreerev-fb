 1) how much information to se about deals between friends and friends friends?
    facebook: Shows status from friends on wall - do not show status from friends friends on wall
    Show gifts started by friends as giver or receiver with all pictures and comments
    Anonymous gifts started by friends friends as giver or receiver and with friends as receiver or giver
    - display received at and balance.
    - hide picture and name of friends friend
    - hide text and pictures

 2) compare JS timezone with rails timezones - there could be differences
    I have tested with copenhagen and india
    Rails timezones:
    - ActiveSupport::TimeZone.all.collect { |tz| (tz.tzinfo.current_period.utc_offset / 60.0 / 60.0).to_s }.uniq
    - ["-11.0", "-10.0", "-9.0", "-8.0", "-7.0", "-6.0", "-5.0", "-4.5", "-4.0", "-3.5", "-3.0", "-2.0", "-1.0",
       "0.0", "1.0", "2.0", "3.0", "3.5", "4.0", "4.5", "5.0", "5.5", "5.75", "6.0", "6.5", "7.0", "8.0", "9.0",
       "9.5", "10.0", "11.0", "12.0", "12.75", "13.0"]
    javascript timezones:
    wiki: http://en.wikipedia.org/wiki/Time_zone#List_of_UTC_offsets
    wiki/rails problems: -9.5, 10.5, 11.5 and 14 is defined in wiki, but not in rails
    rails: http://api.rubyonrails.org/classes/ActiveSupport/TimeZone.html
    The version of TZInfo bundled with Active Support only includes the definitions necessary to support the zones
    defined by the TimeZone class. If you need to use zones that aren't defined by TimeZone, you'll need to install
    the TZInfo gem (if a recent version of the gem is installed locally, this will be used instead of the bundled version

 3) add date format. see application_helper.format_date

 4) api notifications:
    get a app access token.
    send only notifications to api if internal notifications in app is not read.
    Short summary of unread app notifications in api notification
    Only few api notifications and stop sending messages if user do not start app
    for example notification every 1, 2, 4, 7, 14, 28 day
    one notification every day if user connects to app.
    don't send any more notifications if user has not been connected for 28 days
    check out facebook, linkedin & twitter notification possibilities

 5) close account and delete all data in app
    account - recalculate all relevant user balances (closed deals)
    notification to users with changed balance?

 7) One balance for user with more than one login api.
    user must select "Share balance" in users/show screen to set user.user_combination
    recalculate balance will calculate one shared balance
    no other information is shared access login api's

 8) add accept conditions for new users?

11) new deal / cancel / accept / reject error handling
    errors are written to tasks errors table in top of page
    but that is a problem as user maybe not sees error message
    add ajax:error - tasks error table is in top of page and user may not see error message
    better to ajax inject error messages as if it was a new comment above new comment line

12) make script to compare language files (en, da etc). Find missing keys
    check out https://github.com/tigrish/i18n-spec
    could be used to verify that all keys exists

13) recalculate user balance at request or once every day

14) user.recalculate_balance recalculates balance for all closed deals with user as giver or receiver.
    ok when few closed deals for a user, but can be a performance issue with many closed deals for a user.
    allow recalculating balance from a specific date or from a specific gift.id
    should only recalculate balance from last closed deal

16) batch processing:
    accept new deal - set new_balance_at = yesterday - for both users - user is marked for recalculate balance (ok)
    batch processing - recalculate balance for all users where new_balance_at != today (todo)

17) check texts in views/fb/create.html.erb and create_da_html.erb

18) show a more informative page when not logged in
    ensure that all not logged users is rendered to same page (auth/index)
    this page is also index by search engines and should be informative
    maybe the same texts as in /fb/create.html.erb and create_da_html.erb pages

19) check todo's in source

20) add language to url (ok)
    use url helpers in views so that locale is included in all links
    there are problems with pictures on dev1 server
    allow users to select language in app

21) difference between facegook & linkedin friends and google+ & twitter friends
    facebook & linkedin friends are mutual friends
    google+ and twitter friends are not mutual friends
    added constant hash API_MUTUAL_FRIENDS with true/false for each login provider
    how to handle not mutual friends in gofreerev? (google+ and twitter)

22) invite friends to user gofreerev.
    facebook (ok) - todo: retest
    google+ (todo) -
    linkedin (todo)
    twitter (todo)

26) delete api_gifts and gifts with temp picture urls - that is picture on server
    normally temp pictures will be removed in util.delete_local_picture, but errors can occur
    should be a job for util.new_messages_count or util.missing_api_picture_urls
    process could be:
    1) delete old local picturs.
    2) report missing picture to util.missing_api_picture_urls,
    3) cleanup in util.missing_api_picture_urls
    3/1-2014: temp folder was empty in laptop dev. environment
    19/1-2014: 3 pictures found in temp folder in laptop dev. environment

27) accept deal: must add giver/receiver for all api gift rows
    gift created by user a logged with 3 api providers
    gift accepted by user b logged in with 2 api providers.
    how to set user_id_giver / user_id_receiver for the last api_gift?
    match login users with comment user
    check user_combination for comment user to test if other user also uses multiple logins
    map api gifts provider for provider (login users <=> comment users)
    use dummy user "gofreerev/<provider>" if no provider match between login user(s) and comment user(s)

29) where to send notifications for a user with multiple logins?
    solution. one notification for each provider.
    Maybe find some way to combine "identical" notifications in inbox/index page

31) stress test. make a db with really many rows and test performance.
    There maybe are missing an index or two
    there maybe are some sql to rewrite

32) some problems in user.recalculate balance after splitting gifts in gifts and api_gifts
    check /auth/facebook and post_login error for price

33) follow/unfollow gift:
    user logged in as provider 1 selects to follow gift
    user logged in as provider 2 selects to unfollow gift
    show unfollow link when user is logging in as provider 1 and 2?

35) twitter returns to  127.0.0.1 - not to localhost
    127.0.0.1 should redirect to localhost
    or change app setup on twitter

36) post on linkedin
    add link to gift
    add offers/seeks prefix in description
    upload picture

37) check session variables
    session variables should only be used from accessor methods in app. controller
    gives a better overview and an easier to maintain code

38) tests - needs new users.yml file - encryption now is with old userids

39) wrong flash message if user cancel request for read_stream permission
    looks like success response from facebook to facebook controller,
    but read_stream priv has not been granted.
    must double check permissions after returning from facebook priv. request page
    or old/new facebook priv. could be checked in post_login_facebook with ajax messages

40) deep link - return nice error page if deep link has been removed

41) test case:
    create deal [ a.provider1, a.provider2] as giver, [ b.provider1, b.provider2 ] as receiver, price > 0
    login as a.provider1 and b.provider2
    problem with user/show balance. logged users are giver and receiver at the same time
    must be displayed as 0 in balance
    check code with [ag.user_id_giver, ag.user_id_receiver].index(user_id)
    check code with login_user_ids.index(ag.user_id_giver)
    check code with api_gift = api_gifts.find { |ag| [ ag.user_id_giver, ag.user_id_receiver].index(???)

42) generalize invite_friends_url

33) find optimal image format for each provider. For API_OG_DEF_IMAGE hash
    facebook: todo
    google+: todo
    linkedin: 180 x 110 (done)
    twitter: todo
    must be tested from an public available server (dev1.gofreerev.com)

35) users/show user2=login_user
    add link/button to set/remove user_combination for logged in users

45) users/edit is not implemented
    maybe use user/show and ajax for minor updates (post_on_wall_yn and set/clear user_combination)

36) add mysql development environment on localhost.
    there are some select statements that are not working in mysql
    maybe is only was problem with "" around table names!

37) dev1 - first post for a new day takes long time to complete
    suspect exchange rate lookup
    don't know if I was waiting for process or waiting for apache to start a new instance of rails
    post ok, but new gift fields was first cleared after 5-10 seconds when response came from post_on_facebook task
    increased sleep period before submitting do_tasks from 100 to 200 milliseconds (gifts/create.js.erb)

38) performens tuning. gifts/index ajax get 10 rows takes 7 seconds on localhost.
    is a problem for user that can se many gifts in gifts/index page
    Observations:
    - render api_gifts tages 2 seconds. check out user_div (62 ms) and comments2 (40 ms)
    - try something like "select * from table where sort_id < last_sort_id limit 10" with index on sort_id
    - should only fetch relevant rows
    second test 4/1-2014
    - render 10 rows takes 2 seconds (total 368 rows)
    - big selects to get gift_likes, one select for each provider
    check out rails performens tools:
    - http://37signals.com/svn/posts/3091-pssst-your-rails-application-has-a-secret-to-tell-you
    - http://www.cheynewallace.com/ruby-on-rails-performance-tuning/
    - http://pivotallabs.com/rubyrails-performance-tools/
    - https://github.com/MiniProfiler/rack-mini-profiler
    could add a work table with api gifts ids that is initialized in first http request
    get rows from work table in the following show-more-rows ajax requests
    add a expire timestamp for data i work table. For example cleanup after xx minutes
    maybe initialize work table in a ajax tasks so that user don't have to wait for work table to be initialized
    request will be slow until work table has been initialized
    maybe start initialize of work table as a post login task

41) insert "?" picture in /user div/ temporary real profile picture has been downloaded from API
    there is a minor profile picture problem first time when a new gofreerev user logs in

43) problem after show-more-rows error
    javascript variable end_of_page is set to true and is never changed back to false
    share link does not set end_of_page variable back to false
    /gifts/index does set end_of_page back to true
    maybe use document.ready to set end_of_page to false when user clicks on share link i page header
    google a solution

44) users/show page - add special friend status for logged in user
    status: You
    no friend actions
    maybe use add gofreerev friend button to set user_combination across login api's


48) change language LOV or link

49) add api friend
    - facebook: link to profile
    - linkedin: todo
    - google+: todo
    - twitter: todo

50) remove api friend:
    - facebook: link to profile
    - linkedin: todo
    - google+: todo
    - twitter: todo

51) check notifications and change notification test cases to support multiple logins

52) check app on windows 8.1 / IE
    maybe it is possible to run older IE versions under windows 8.1?
    expects that some javascript does not work with IE

53) better github page

54) links on app setup page to github page

55) post on linkedin from localhost
    can not upload picture with localhost url to linkedin
    add a special error message for this case?

56) invalid deep link requests
    should display an error page
    must not redirect for not logged in users

57) find ip-adr for login providers
    dev1 should only be open for login providers and testers
    not for public

59) add server site cleanup for api_gifts with temp url
    created in gifts/create - removed in util.delete_local_picture after post_on_<provider> tasks

65) profile picture store = :api.
    add onload/onerror handler to profile picture to check for invalid profile picture urls
    should display no-picture.jpg if user profile picture was not found

69) check if user div onclick events could be handled on a higher level - for example on document
    can not use user_id in id. user divs are repeated many times for each user.
    use data-id attribute for user.id

70) link from post on gofreerev to post on facebook. api_gift.api_gift_id => url
    but only if FB friend

71) link from post on gofreerev to post on linkedin. updateUrl
    but only if LinkedIn connection

75) problem with api gifts without gifts
    check out where gifts are deleted
    added Gift.check_gift_and_api_gift_rel test to util.new_messages_count and util.delete_gift

78) facebook and open graph
    - replace api_client.put_picture and api_client.put_connections with something else to add open graph tags?
    - facebook object api: https://developers.facebook.com/docs/opengraph/using-object-api/
    - koala with og.likes:
      http://stackoverflow.com/questions/12199608/koala-like-doesn-t-work
      api_response = api.put_connections("me", "og.likes", :object => deep_link)
      can be used, but requires :local gift picture store and activity is  only shown in activity log / not on wall
    - facebook object debugger: https://developers.facebook.com/tools/debug/

84) check response from FastImage.type(gift_file.path) if site is temporary unavailable
    should not error mark pictures if a api picture server is temporary out of service
    FastImage.type returns nil if server is temporary unavailable
    Must combine FastImage = nil with a http get page notfound check
    http://stackoverflow.com/questions/2695020/how-can-i-use-ruby-to-check-if-a-domain-exists

87) found class wrapword in source - used in api_gift.html.erb - could be a workaround for response web pages with small width

90) user/show: add provider filter if logged in with more when one provider

91) add share icons to api_gift (one icon for each api provider)
    share with a deep link
    allow all to share og allow only creator to share?
    http://jquery-plugins.net/tag/social-share-button

92) inject text into picture
    most relevant for twitter where description is truncated to about 70 characters to include deep link
    but could be an option for all login providers
    for example a merge text and picture checkbox when posting new gift

93) check user.post_gift_allowed? class and instance method
    there should be an post_gift_allowed? method and a post_image_allowed? method.
    post_gift_allowed ok if permission and post_on_wall setting is ok
    post_image_allowed ok if login in users and gift picture store setting is ok.

94) post image upload
    fix missing google+ picture if logged in with other login providers when picture was uploaded
    that is - url from a google api_gift to a picture from from one of the other login providers
    for example in util.delete_local_picture

95) giver/receiver of gift should be allowed to delete comments

96) my.js - split gift-action-link ajax handler in one for each gift action?
    should use translated error messages in js error messages

97) my.js - split comment-action-link ajax handler in one for each comment action?
    should use translated error messages in js error messages

98) deal proposal and changed friend relations
    cancel deal proposal when friends are removed
    could be rejected friends in users/index page
    could be changed api friend relation in post login task

99) inject ajax error messages to more specific area in gifts/index page
    could by error tables within page
    - gift-<giftid>-links-errors
    - gift-<giftid>-comment-new-errors
    - gift-<giftid>-comment-<commentid>-errors
    problem: many extra tables in gifts/index page that always never will be used
    could add a hidden destination column to @error injection in gifts/index page
    error as injected in page header and then moved to more specific location
